{% load static %}

<div class="bg-white rounded-lg shadow-sm border border-gray-200">
    {% csrf_token %}
    
    <div class="p-4">
        <h2 class="text-lg font-semibold mb-4">Editor de Recomendación</h2>
        
        <div class="mb-4">
            <label class="inline-flex items-center">
                <input type="checkbox" 
                       id="use-default" 
                       name="use-default"
                       {% if recommendation.use_default %}checked{% endif %}
                       class="form-checkbox">
                <span class="ml-2">Usar recomendación por defecto</span>
            </label>
        </div>

        <div id="recommendation-editor" class="{% if recommendation.use_default %}hidden{% endif %}">
            <textarea id="recommendation-text"
                      data-health-category-id="{{ health_category.id }}"
                      class="w-full p-2 border rounded"
                      rows="4">{{ recommendation.text }}</textarea>
        </div>

        <div class="mt-4">
            <select id="status-color" class="form-select">
                <option value="verde" {% if recommendation.status_color == 'verde' %}selected{% endif %}>Verde</option>
                <option value="amarillo" {% if recommendation.status_color == 'amarillo' %}selected{% endif %}>Amarillo</option>
                <option value="rojo" {% if recommendation.status_color == 'rojo' %}selected{% endif %}>Rojo</option>
                <option value="gris" {% if recommendation.status_color == 'gris' %}selected{% endif %}>Gris</option>
            </select>
        </div>

        <div class="mt-4 space-x-4">
            <label class="inline-flex items-center">
                <input type="checkbox" 
                       id="is-draft"
                       {% if recommendation.is_draft %}checked{% endif %}
                       class="form-checkbox">
                <span class="ml-2">Borrador</span>
            </label>
            
            <label class="inline-flex items-center">
                <input type="checkbox" 
                       id="sign-recommendation"
                       class="form-checkbox">
                <span class="ml-2">Firmar</span>
            </label>
        </div>

        <div class="mt-4">
            <button type="button" 
                    id="save-recommendation" 
                    class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                Guardar Cambios
            </button>
        </div>
    </div>

    <div class="p-4 bg-gray-50 text-sm text-gray-600">
        Última actualización: {{ recommendation.updated_at|date:"d/m/Y H:i" }}
        {% if recommendation.is_signed %}
        • Firmado por {{ recommendation.signed_by }}
        {% endif %}
    </div>
</div>

<script src="{% static 'admin/js/recommendation_editor.js' %}"></script> 