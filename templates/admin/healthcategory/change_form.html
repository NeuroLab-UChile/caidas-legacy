{% extends "admin/change_form.html" %}
{% load i18n admin_urls static %}

{% block extrastyle %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'admin/css/recommendation.css' %}">
{% endblock %}

{% block content %}
<div class="recommendation-container">
    <!-- Panel de Evaluación -->
    <div class="evaluation-panel">
        <h2>Datos de Evaluación</h2>
        <div class="evaluation-content">
            {% if evaluation_data.responses %}
                {% for question in evaluation_data.question_nodes %}
                    <div class="evaluation-item">
                        <strong>{{ question.text }}</strong>
                        <p>{{ evaluation_data.responses|get_item:question.id }}</p>
                    </div>
                {% endfor %}
            {% else %}
                <p class="no-data">No hay datos de evaluación disponibles</p>
            {% endif %}
        </div>
    </div>

    <!-- Panel de Recomendación -->
    <div class="recommendation-panel">
        <h2>Recomendación Profesional</h2>
        <div class="recommendation-toolbar">
            <div class="status-selector">
                <label>Estado:</label>
                <select id="statusColor">
                    <option value="verde" {% if recommendation_data.status_color == 'verde' %}selected{% endif %}>Verde</option>
                    <option value="amarillo" {% if recommendation_data.status_color == 'amarillo' %}selected{% endif %}>Amarillo</option>
                    <option value="rojo" {% if recommendation_data.status_color == 'rojo' %}selected{% endif %}>Rojo</option>
                </select>
            </div>
            <div class="draft-toggle">
                <label>
                    <input type="checkbox" id="isDraft" {% if recommendation_data.is_draft %}checked{% endif %}>
                    Borrador
                </label>
            </div>
        </div>
        
        <div class="recommendation-editor">
            <textarea id="recommendationText" 
                      placeholder="Escriba su recomendación aquí..."
                      rows="10">{{ recommendation_data.text|default:'' }}</textarea>
        </div>

        <div class="recommendation-actions">
            <button type="button" class="save-button" onclick="saveRecommendation()">
                Guardar Recomendación
            </button>
            <button type="button" class="preview-button" onclick="previewRecommendation()">
                Vista Previa
            </button>
        </div>

        <div class="recommendation-meta">
            {% if recommendation_data.updated_by %}
                <p>Última actualización por: {{ recommendation_data.updated_by }}</p>
                <p>Fecha: {{ recommendation_data.updated_at|date:"d/m/Y H:i" }}</p>
            {% endif %}
        </div>
    </div>
</div>

{{ block.super }}
{% endblock %}

{% block extrajs %}
{{ block.super }}
<script type="text/javascript" src="{% static 'admin/js/recommendation.js' %}"></script>
{% endblock %} 